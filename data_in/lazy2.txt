#include "data_in/printy.txt"
#include "data_in/consolescreen.txt"
#include "data_in/class_screen.txt"

int infloop() 
	int I = 0;
	while(1)
		writePort(7, I++);
	end 
end

void writePort(int port, int val)
   char* mem_port = 65536;
   mem_port[port] = val;
end

void printXY(char *str, int X, int Y)
	int *scr_adr = AdrScreen;//65536+100;
	while(*str)
		char C = *str++;
		int adr = (X+30*Y)*2;
		scr_adr[adr] = C;
		scr_adr[adr+1] = 999;
		X++;
	end
end

//int numOfPrint = 0;
int printX = 0;

void print(char *str)
	//printXY(str, 0, 0);
	printXY(str, printX, 0);
	printX = printX + strlen(str);
	//numOfPrint++;
	//my_num++;
	//if(numOfPrint > 19) numOfPrint = 0; end
end

void printnum2(int num)
	if(num < 0) print("(<0)"); end
	if(num == 0) print("(0)"); end
	if(num == 1) print("(1)"); end
	if(num == 2) print("(2)"); end
	if(num == 3) print("(3)"); end
	if(num == 4) print("(4)"); end
	if(num == 5) print("(5)"); end
	if(num == 6) print("(6)"); end
	if(num == 7) print("(7)"); end
	if(num == 8) print("(8)"); end
	if(num == 9) print("(9)"); end
	if(num == 10) print("(10)"); end
	if(num > 10) print("(>10)"); end
end

void fillderp(char *buff, int size, char *dz)
	int len = strlen(dz);
	for(int i = 0; i < size; i++)
		buff[i] = dz[i%len];
	end
	buff[size-1] = 0;
end

void printnum3(int num)
	char buff[10];
	fillderp(buff, 10, "derp");
	//print("<"); print(buff); print(">");
	int2str(num, buff);
	//print("<"); print(buff); print(">");
	print(buff);
end

void printc(char c)
	char arr[2];
	arr[0] = c;
	arr[1] = 0;
	print(arr);
end

void printnl()
	printX = printX+30 - (printX%30);
end

void dbgprint(char *str10, int num10, char c10)
	print(str10);
	printnum2(num10);
	print("["); printc(c10); print("]");
	printnl();
end

void delay(int n)
	float k = 1/32;
	for(int i = 0; i < n*k; i++)
	end
end

void clock()
	int i = 0;
	while(1)
		printnum2(i++);
		if(i > 10) i = 0; end
		delay(1000);
	end
end

void iftest(int n)
	print("iftest: if("); printnum3(n); print(" == 2): ");
	if(n == 2)
		print("yes.");
	else
		print("no.");
	end
	print("end."); printnl();
end


void iftest2(int n)
	print("iftest2: if("); printnum3(n); print(" == 2): ");
	if(n == 2)
		print("yes.");
	end
	if(n != 2)
		print("no.");
	end
	print("end."); printnl();
end

int main(int argc, char **argv)
	class Screen scr;
    screen_set(65536+100);
	screen_clear();
	print ("hello world! ");
	libconsolescreen_init();
	print ("another hello"); printnl();
	//print("num 5 = "); printnum2(5); print(", ok"); printnl();
	//print("char S = ["); printc('S'); print("]"); printnl();
	//print("num 123 = ["); printnum3(123); print("]"); printnl();
	//iftest(2);
	//iftest(3);
	//iftest2(2);
	//iftest2(3);
	print("ok.");
	//delay(2000);
	screen_clear();
	setPrintCursor(0,0);
	//Prints("ohai ",999); Printn(123,999); Prints(" yep",999);
	printf("hi%dm\nye\n",1);
	infloop();
	printf("printf test1\n");
	//setPrintCursor(0,1);
	printf("printf [%d] test2\n", 123);
	//setPrintCursor(0,2);
	printf("printf [%f] test3\n", 21/4);
	//setPrintCursor(0,3);
	printf("printf [%s] test4\n", "hello");
	//setPrintCursor(0,4);
	printf("printf [%c] test5\n", '\');
	//writePort(0, &scr);
	//writePort(1, &(scr.X));
	//writePort(2, &scr.X);
	//writePort(3, scr.X);
	//scr.X = 123;
	//scr.print("hello world!");
	//scr.test();
	//writePort(6, scr.X);
	//print("well, I tried", 0, 0);
	//for(int i = 0; i < 10; i ++)
	//	char *str = lorem_ipsum(i);
	//	printXY(str, 0, i);
	//end
	printXY("done", 0, 11);
	//clock();
	infloop();
end

